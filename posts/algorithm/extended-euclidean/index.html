<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>[알고리즘] 확장 유클리드 알고리즘  | 배하람 블로그</title>
  <meta name="description" content="desribe-your-site '[알고리즘] 확장 유클리드 알고리즘'을 한 번 살펴보세요.">
  <meta property="og:title" content="[알고리즘] 확장 유클리드 알고리즘">
  
  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2019-07-08">
  
  <meta property="og:description" content="desribe-your-site '[알고리즘] 확장 유클리드 알고리즘'을 한 번 살펴보세요.">
  <meta property="og:url" content="https://baeharam.github.io/posts/algorithm/extended-euclidean/">
  <meta property="og:site_name" content="배하람 블로그">
  
  <meta property="og:image" content="https://baeharam.github.io/images/thumbnail.png">
  
  
  <meta property="og:tags" content="알고리즘">
  
  <meta property="og:tags" content="유클리드 호제법">
  
  <meta property="og:tags" content="베주 항등식">
  
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="canonical" href="https://baeharam.github.io/posts/algorithm/extended-euclidean/">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/agate.min.css">
  <link href="https://fonts.googleapis.com/css?family=Nanum+Gothic:400,800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/styles.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXX-X"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-XXXXXXXX-X');
  </script>
  
  
  <script type="text/javascript">
  function toggle_visibility(id) {
    var e = document.getElementById(id);
    if (e.className === 'menu')
      e.className = 'menu hidden';
    else
      e.className = 'menu';
  }
  </script>
</head>
<body>
  <div class="navbar">
    <div class="burger">
      <button onclick="toggle_visibility('menu')">
        <i class="fa fa-bars" aria-hidden="true"></i> 메뉴
      </button>
    </div>
    <div id="menu" class="menu hidden">
      <ul>
        <li><a href="/">배하람 블로그</a></li>
        <li><a href="/categories">카테고리</a></li>
        <li><a href="/tags">태그</a></li>       
      </ul>
      <input class="search" id="search-input" type="search" placeholder="검색어" value="">
    </div>
  </div>
  <div class="container">    

<div class="post">
  <div class="post-title">
    <a href="https://baeharam.github.io/posts/algorithm/extended-euclidean/">
      <div class="post-meta">
        <time>2019년 07월 08일 17시 35분</time>
        <h1>[알고리즘] 확장 유클리드 알고리즘</h1>
      </div>
    </a>
  </div>
  <section class="post-content">
    

<h1 id="유클리드-호제법-euclidean-algorithm">유클리드 호제법(Euclidean algorithm)</h1>

<h2 id="정의">정의</h2>

<p>유클리드 호제법(= 유클리드 알고리즘)은 두 정수 사이의 최대공약수를 보다 효과적으로 구하는 방법으로 두 정수 $a,b$ 가 존재할 때 다음 식을 만족하는 방법론을 일컫는 말이다.
$$
GCD(A,B) = GCD(B,r)
$$
이 때 $A\gt B$ 가 성립하며 $A\equiv r\ (mod\ B)$ 를 조건으로 한다.</p>

<h2 id="증명">증명</h2>

<p>두 정수 $A,B(A \gt B)$ 의 최대공약수(GCD)를 $G$ 라고 하자. $G$ 는 공약수이므로 두 서로소 $a,b$ 에 대해 다음 식이 성립한다.
$$
A=aG, B=bG
$$
$A$ 를 $B$ 로 나눈 나머지를 $r$ , 몫을 $q$ 라고 하면 $A=qB+r\ (0\le r \lt \lvert B \rvert)$ 를 만족한다. 이 식과 위의 식을 이용해서 새로운 식을 전개해보면 다음과 같다.
$$
aG=bGq+r <br />
r=G(a-qb)
$$
이 때 $B$ 와 $r$ 의 최대공약수가 $G$ 임을 보이면 증명이 끝나는데 이는 $b$ 와 $a-qb$ 가 서로소임을 증명하는 것과 같다. 귀류법을 사용하여 $b$ 와 $a-qb$ 가 서로소가 아니라고 가정해보자. 서로소가 아닐 경우 2이상의 최대공약수가 존재하며 그걸 $p$ 라고 하면 두 정수 $n,m$ 에 대하여 다음 식이 성립한다.
$$
b=np, a-qb=mp
$$
$a-qb=mp$ 는 다시 $b=np$ 를 이용해 아래와 같이 전개할 수 있다.
$$
\begin{align}
a&amp;=qb+mp \\<br />
&amp;=qnp+mp \\<br />
&amp;=(qn+m)p
\end{align}
$$
위 식에 의해서 $a,b$ 는 공약수인 $p$ 를 가지게 되는데 가장 처음에 가정했던 $a,b$ 가 서로소라는 것에 모순이 되기 때문에 $b, a-qb$ 는 반드시 서로소여야 한다. 따라서 $GCD(B,r)=G$ 가 성립한다.</p>

<h2 id="구현">구현</h2>

<pre><code class="language-c++">int gcd(int a, int b)
{
  if(b==0) return a;
  return gcd(b,a%b);
}
</code></pre>

<h1 id="베주-항등식-bezout-s-identity">베주 항등식(Bezout&rsquo;s Identity)</h1>

<h2 id="정의-1">정의</h2>

<p>확장 유클리드 호제법을 공부하기 전에 먼저 베주 항등식을 알아야 하는데 그 이유는 확장 유클리드 호제법이 베주 항등식의 명제를 가정으로 하여 해를 구하는 방법이기 때문이다. 3가지 참인 명제가 있으며 이는 아래와 같다.</p>

<p>$GCD(a,b)=d$ 라고 할 때,</p>

<ul>
<li>$ax+by=d$ 를 만족하는 정수 $x,y$ 가 존재한다.</li>
<li>$d$ 는 정수 $x,y$ 에 대하여 $ax+by$ 로 표현할 수 있는 가장 작은 정수이다.</li>
<li>$ax+by$ 로 표현될 수 있는 모든 정수는 $d$ 의 배수이다.</li>
</ul>

<h2 id="증명-1">증명</h2>

<p>둘 중 하나는 0이 아닌 정수 $a,b$ 에 대하여 집합 $S$ 를 다음과 같이 정의하자.
$$
S={ax+by\gt 0 \ | \ x,y \in \mathbb Z}
$$
집합 $S$ 는 위 정의에 따라 자연수의 부분집합이고 $S$ 가 공집합이 아니라면 <u>자연수의 정렬성</u>인 <strong>&ldquo;자연수의 부분집합이 공집합이 아닐 경우 가장 작은 값을 원소로 가진다.&rdquo;</strong> 에 따라서 가장 작은 값을 원소로 가진다. 따라서 $S$ 가 공집합이 아니라는 것을 증명하면 $S$ 가 $ax+by$ 로 나타낼 수 있는 가장 작은 자연수를 원소로 가진다는 사실을 증명할 수 있다.
$$
\lvert a \rvert=
\begin{cases}
a\times 1+ b\times 0 \in S &amp; \text{if}\ a \gt 0\\<br />
a\times -1+ b\times 0 \in S &amp; \text{if}\ a \lt 0\\<br />
0,\ b\neq 0 &amp; \text{if}\ a = 0<br />
\end{cases}
$$
위 3가지 경우에 대해 모두 $\lvert a \rvert$ 가 $S$ 에 속하기 때문에 $\lvert a\rvert$ 나 $\lvert b\rvert$ 중 적어도 1개가 $S$ 에 속한다는 것을 알 수 있다. 따라서 위에서 언급한 자연수의 정렬성에 따라 $S$ 는 $ax+by$ 로 나타낼 수 있는 가장 작은 자연수를 원소로 가지며 그것을 $d$ 라고 하자.</p>

<p>임의의 정수 $k,l$ 에 대해 $d=ak+bl$ 로 나타낼 수 있으며 나눗셈 정리에 따라서 $S$ 의 임의의 원소를 $x$ 라고 했을 때 $x=dq+r\ (0\le r\lt d)$ 로 쓸 수 있다. 이 때 $x$ 를 $d$ 의 배수가 아니라고 가정하면 $r\neq 0$ 이므로 자연수라고 할 수 있고 $x$ 가 $S$ 에 속하기 때문에 임의의 정수 $u,v$ 에 대해 $x=au+bv$ 로 나타낼 수 있다. 이걸 종합해서 $r$ 에 대해 풀어쓰면 다음과 같다.
$$
\begin{align}
r&amp;=x-dq&amp;\\<br />
&amp;=(au+bv)-dq\\<br />
&amp;=(au+bv)-(ak+bl)q\\<br />
&amp;=au-akq+bv-blq\\<br />
&amp;=a(u-kq)+b(v-lq) \in S
\end{align}
$$
이 때 $r$ 은 $d$ 로 나눈 나머지이기 때문에 $d$ 보다 작은데, $d$ 의 정의가 $S$ 에서 가장 작은 자연수이므로 모순이다. 따라서 처음에 가정했던 &ldquo;$x$ 가 $d$ 의 배수가 아니다&rdquo; 라는 가정은 거짓이 되므로 $x$ 는 $d$ 의 배수이다. 여기서 $x$ 는 $S$ 의 임의의 원소이기 때문에 $S$ 의 모든 원소는 $d$ 의 배수이다. $\lvert a\rvert,\lvert b\rvert$ 중 적어도 하나는 $S$ 의 원소이기 때문에 $d$ 는 $a,b$ 의 공약수가 된다.</p>

<p>$GCD(a,b)=G,\ a=AG,\ b=BG$  일 때, $d=ak+bl=AGk+BGl=G(Ak+Bl)$ 이 성립하므로 $d$ 는 $G$ 의 배수이다. 위에서 $d$ 가 $a,b$ 의 공약수였기 때문에 $d$ 는 $G$ 의 약수이면서 배수이게 된다. 따라서 $d=G=GCD(a,b)$ 가 성립하며 증명이 끝난다.</p>

<h1 id="확장-유클리드-호제법-extended-euclidean-algorithm">확장 유클리드 호제법(Extended Euclidean Algorithm)</h1>

<h2 id="정의-2">정의</h2>

<p>베주 항등식에 따라서 $GCD(a,b)=d$ 라고 할 때 $ax+by=d$ 를 만족하는 $x,y$ 가 존재하며 이는 유클리드 호제법의 과정을 역으로 따라가면 찾을 수 있다. 따라서, 유클리드 호제법의 과정을 따라가봐야 한다. 두 정수 $a,b$ 에 대해 나눗셈 정리와 유클리드 호제법을 반복하여 다음과 같이 나열할 수 있다.</p>

<p>$$
\begin{align}\\<br />
a=bq_0+r_1\\<br />
b=r_1q_1+r_2\\<br />
r_1=r_2q_2+r_3\\<br />
&hellip;\\<br />
r_{i-1}=r_iq_i+r_{i+1}\\<br />
\end{align}
$$</p>

<p>여기서 $r_{i+1}=r_{i-1}-r_iq_i$ 를 얻을 수 있고 $r_{i+1}=0$ 일 때 알고리즘이 종료된다는 것을 알 수 있다. 여기서 $d$ 는 $r_i$ 이므로 $ax+by$ 꼴로 나타내기 위해서 $r_0=a, r_1=b$ 라고 하면 $r_0=a\times 1+b\times 0$ 이 되고 $r_1=a\times 0+b\times 1$ 이 된다. 이는 이후의 $r_i$ 도 같은 꼴로 나타내어진다는 것을 알 수 있다. 이 때 임의의 $r_i$ 에 대해 $a$ 의 계수를 $s_i$, $b$ 의 계수를 $t_i$ 라고 하면 아래와 같이 표현할 수 있다.
$$
r_i = s_ia+t_ib
$$
이를 $r_{i+1}=r_{i-1}-r_iq_i$ 에 대입하면 다음 점화식을 얻어낼 수 있다.
$$
\begin{align}
s_{i+1}a+t_{i+1}b&amp;=(s_{i-1}a+t_{i-1}b)-(s_ia+t_ib)q_i\\<br />
&amp;=s_{i-1}a-s_iaq_i+t_{i-1}b-t_ibq_i\\<br />
&amp;=(s_{i-1}-s_iq_i)a+(t_{i-1}-t_iq_i)b
\end{align}
$$
이제까지의 식을 총정리하면 다음과 같다.
$$
r_0=a,\ r_1=b\\<br />
s_0=1,\ s_1=0\\<br />
t_0=0,\ t_1=1\\<br />
r_{i+1}=r_{i-1}-r_iq_i\\<br />
s_{i+1}=s_{i-1}-s_iq_i\\<br />
t_{i+1}=t_{i-1}-t_iq_i
$$</p>

<h2 id="구현-1">구현</h2>

<pre><code class="language-c++">void EEA(int a, int b)
{
  int r0=a, r1=b;
  int s0=1, s1=0;
  int t0=0, t1=1;
  int temp=0,q=0;
  
  while(r1){
    q=r0/r1;
    temp=r0;
    r0=r1;
    r1=temp-r1*q;
    temp=s0;
    s0=s1;
    s1=temp-s1*q;
    temp=t0;
    t0=t1;
    t1=temp-t1*q;
  }
}
</code></pre>

<h2 id="참고">참고</h2>

<ul>
<li><a href="https://blog.naver.com/PostView.nhn?blogId=kks227&amp;logNo=221414840544&amp;parentCategoryNo=&amp;categoryNo=299&amp;viewDate=&amp;isShowPopularPosts=true&amp;from=search">확장 유클리드 알고리즘</a></li>
<li><a href="[https://ko.wikipedia.org/wiki/%EC%9C%A0%ED%81%B4%EB%A6%AC%EB%93%9C_%ED%98%B8%EC%A0%9C%EB%B2%95#%ED%98%B8%EC%A0%9C%EB%B2%95%EC%9D%98_%ED%99%95%EC%9E%A5](https://ko.wikipedia.org/wiki/유클리드_호제법#호제법의_확장)">유클리드 호제법의 확장</a></li>
<li><a href="https://chin0.github.io/algorithm/math/egcd/">확장 유클리드 알고리즘</a></li>
<li><a href="https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm">Extended Euclidean Algorithm</a></li>
<li><a href="[https://namu.wiki/w/%EB%B2%A0%EC%A3%BC%20%ED%95%AD%EB%93%B1%EC%8B%9D#fn-1](https://namu.wiki/w/베주 항등식#fn-1)">베주 항등식</a></li>
</ul>

  </section>
  <div class="share">    
    <a
      href="//www.facebook.com/sharer.php?src=bm&u=https%3a%2f%2fbaeharam.github.io%2fposts%2falgorithm%2fextended-euclidean%2f&t=%5b%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98%5d%20%ed%99%95%ec%9e%a5%20%ec%9c%a0%ed%81%b4%eb%a6%ac%eb%93%9c%20%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98"
      onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"
      ><i class="fa fa-facebook"></i
    ></a>
    <a
      href="//twitter.com/intent/tweet?url=https%3a%2f%2fbaeharam.github.io%2fposts%2falgorithm%2fextended-euclidean%2f&text=%5b%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98%5d%20%ed%99%95%ec%9e%a5%20%ec%9c%a0%ed%81%b4%eb%a6%ac%eb%93%9c%20%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98&tw_p=tweetbutton"
      onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"
      ><i class="fa fa-twitter"></i
    ></a>
    <a
      href="//getpocket.com/edit?url=https%3a%2f%2fbaeharam.github.io%2fposts%2falgorithm%2fextended-euclidean%2f&title=%5b%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98%5d%20%ed%99%95%ec%9e%a5%20%ec%9c%a0%ed%81%b4%eb%a6%ac%eb%93%9c%20%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98"
      onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"
      ><i class="fa fa-get-pocket"></i
    ></a>
    <a
      href="//plus.google.com/share?url=https%3a%2f%2fbaeharam.github.io%2fposts%2falgorithm%2fextended-euclidean%2f"
      onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"
      ><i class="fa fa-google-plus"></i
    ></a>
  </div>
  <div class="post-meta-code">
    <div class="desc">
      
      <a href="mailto:gkfka6484@gmail.com">배하람</a>
      
      님이
      <span class="highlight">2019년 07월 08일 17시 35분</span> 
      에 작성한 글입니다.
    </div>
    <div class="desc">
      
      <div class="desc">
        <span class="fixed-desc">_카테고리</span>
        
        
        <a href="https://baeharam.github.io/categories/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98">#알고리즘</a>
        
      </div>
      
      <div class="desc">
        <span class="fixed-desc">_태그</span>
        
        
        <a href="https://baeharam.github.iotags/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98">#알고리즘</a>
        
        <a href="https://baeharam.github.iotags/%EC%9C%A0%ED%81%B4%EB%A6%AC%EB%93%9C-%ED%98%B8%EC%A0%9C%EB%B2%95">#유클리드 호제법</a>
        
        <a href="https://baeharam.github.iotags/%EB%B2%A0%EC%A3%BC-%ED%95%AD%EB%93%B1%EC%8B%9D">#베주 항등식</a>
        
        
      </div>
    </div>
  </div>  
  
  <script src="https://utteranc.es/client.js"
        repo="baeharam/blog-comments"
        issue-term="url"
        theme="github-light"
        crossorigin="anonymous"
        async>
  </script>
  
  <div class="recommend-articles">
    다음으로 읽을만한 글입니다.
    <ul>
      
      
      <li>
        <a href="https://baeharam.github.io/posts/algorithm/kmp/" rel="next">
          <span>[알고리즘] KMP 알고리즘</span>
        </a>
      </li>
      
    </ul>
  </div>
</div>

<div class="go-top">
  <a href="#" class="go-top-button">
    <i class="fa fa-angle-double-up"></i>
    <span>위로</span>
  </a>
</div>
<footer class="footer">
  COPYRIGHT (C) <a href="https://blog.lulab.net">DONGGEUN,BANG (LUBANG).</a><br />
  ALL RIGHTS RESERVED.
</footer>
</body>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
</html>

